const User=require("../../models/User").User,parse=require("../../helpers/parseList").parse;module.exports={index:function(e,s){let t=parse("users",e,s,["username"],{isAdmin:!1,role:1},!0);s.json({total:t.total,rows:t.chain.value()})},show:function(e,s){if(e.query.uname){var t=User.findBy({username:e.query.uname});t?(t.contact=contact,s.json({status:!0,user:t})):s.json({status:!1})}},update:function(e,s){let t={id:e.body.id};void 0!=e.body.isActive&&(t.isActive=e.body.isActive);let o=e.body._action;delete e.body._action;let r,n=e.body.password;if(n&&(t.password=n),"reset"==o){let e=User.findBy({username:"admin"});console.log(e.id),t.id=e.id,n="2017-123456",t.passwordInited="2017-123456"==n}"reset"==o||n?(r=User.update(t),s.redirect("/signin")):(r=User.update(e.body),s.json({status:!0,result:r}))},create:function(e,s){let t=User.create(e.body);s.json(t)},createAdmin:function(e,s){User.createAdmin();s.json({})},delete:function(e,s){User.delete(e.body),s.json({status:!0,msg:"删除成功！"})}};