var shortid=require("shortid"),pluralize=require("pluralize");function first(e){return e[0]}function last(e){return e.slice(-1)[0]}function getRemovable(e){var r=this,i=[];return r.each(e,function(t,n){r.each(t,function(t){r.each(t,function(a,u){if(/Id$/.test(u)){var s=pluralize.plural(u.slice(0,-2));if(e[s]){var f=r.getById(e[s],a);r.isUndefined(f)&&i.push({name:n,id:t.id})}}})})}),i}function createId(e){this.__id();return this.isEmpty(e)?1:shortid.generate()}function deepQuery(e,r){var i=this;if(e&&r)if(i.isArray(e)){for(var t=0;t<e.length;t++)if(i.deepQuery(e[t],r))return!0}else if(i.isObject(e)&&!i.isArray(e)){for(var n in e)if(i.deepQuery(e[n],r))return!0}else if(-1!==e.toString().toLowerCase().indexOf(r))return!0}module.exports={getRemovable,createId,last,first,deepQuery};