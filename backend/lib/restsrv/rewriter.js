"use strict";var express=require("express"),url=require("url"),_=require("lodash");function updateQueryString(r,e){return~e.indexOf("?")?_.assign(r,url.parse(e,!0).query):{}}module.exports=function(r){var e=express.Router();return e.get("/__rules",function(e,u){u.json(r)}),Object.keys(r).forEach(function(u){-1!==u.indexOf(":")?e.all(u,function(e,n,t){var a=r[u];for(var s in e.params)a=a.replace(":"+s,e.params[s]);e.url=a,e.query=updateQueryString(e.query,e.url),t()}):e.all(u+"*",function(e,n,t){e.url=e.url.replace(u,r[u]),e.query=updateQueryString(e.query,e.url),t()})}),e};